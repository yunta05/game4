<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ライン固定パズル</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main class="app">
      <header class="topbar">
        <div>
          <h1>ライン固定パズル</h1>
          <p class="subtitle">5×5 / シフト → 合成 → 生成</p>
        </div>
        <div class="top-actions">
          <button id="new-game-btn" type="button">New Game</button>
          <button id="help-btn" type="button">Help</button>
        </div>
      </header>

      <section class="stats" aria-label="stats">
        <div class="stat"><span>Score</span><strong id="score">0</strong></div>
        <div class="stat"><span>Best</span><strong id="best-score">0</strong></div>
        <div class="stat"><span>Max Tile</span><strong id="max-tile">0</strong></div>
        <div class="stat"><span>Best Tile</span><strong id="best-tile">0</strong></div>
      </section>

      <section class="controls" aria-label="line controls">
        <div class="line-picker">
          <h2>行選択</h2>
          <div id="row-buttons" class="button-grid"></div>
        </div>
        <div class="line-picker">
          <h2>列選択</h2>
          <div id="col-buttons" class="button-grid"></div>
        </div>
      </section>

      <section class="board-wrap">
        <div class="direction-buttons" aria-label="direction controls">
          <button data-dir="up" type="button">↑</button>
          <button data-dir="left" type="button">←</button>
          <button data-dir="right" type="button">→</button>
          <button data-dir="down" type="button">↓</button>
        </div>
        <div id="board" class="board" aria-label="game board"></div>
        <div id="floating-layer" class="floating-layer" aria-hidden="true"></div>
      </section>

      <p id="status" class="status" role="status"></p>
    </main>

    <dialog id="help-dialog">
      <article>
        <h2>遊び方</h2>
        <ul>
          <li>1手で「1行または1列」を選んで、上下左右へ1マスシフトします。</li>
          <li>端からはみ出した側は消え、反対端は空白になります（トーラスなし）。</li>
          <li>シフト後、上下左右で隣接した同じ値が自動合成され、値が+1されます。</li>
          <li>合成は連鎖し、同ターン内で1タイルは1回のみ合成対象になります。</li>
          <li>合成後に空セルへ新タイルが1枚出現します（終盤は確率調整）。</li>
          <li>空セル0で生成できないとゲームオーバーです。</li>
        </ul>
        <p>連鎖加点倍率: k回目の合成で「生成値 × (k+1)」。</p>
        <p>キーボード: <code>R/C</code>で行列モード切替、<code>1-5</code>で番号選択、矢印/WASDでシフト。</p>
        <button id="close-help-btn" type="button">閉じる</button>
      </article>
    </dialog>

    <script src="game.js"></script>
  </body>
</html>
